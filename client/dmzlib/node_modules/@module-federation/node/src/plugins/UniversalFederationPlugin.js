"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const StreamingTargetPlugin_1 = __importDefault(require("./StreamingTargetPlugin"));
const NodeFederationPlugin_1 = __importDefault(require("./NodeFederationPlugin"));
class UniversalFederationPlugin {
    constructor(options, context) {
        this._options = options || {};
        this.context = context || {};
    }
    apply(compiler) {
        const { isServer, debug, ...options } = this._options;
        const { webpack } = compiler;
        if (isServer || compiler.options.name === 'server' || compiler.options.target === 'node') {
            new NodeFederationPlugin_1.default(options, this.context).apply(compiler);
            new StreamingTargetPlugin_1.default({ ...options, debug }).apply(compiler);
        }
        else {
            new (this.context.ModuleFederationPlugin ||
                (webpack && webpack.container.ModuleFederationPlugin) ||
                require('webpack/lib/container/ModuleFederationPlugin'))(options).apply(compiler);
        }
    }
}
exports.default = UniversalFederationPlugin;
//# sourceMappingURL=UniversalFederationPlugin.js.map